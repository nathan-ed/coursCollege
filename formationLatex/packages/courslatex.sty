% Packages for Mathematical Symbols and Fonts
\RequirePackage{amsmath}
\RequirePackage{varwidth}
\RequirePackage{amsfonts}
\RequirePackage{amsthm}
\let\eth\relax
\let\backepsilon\relax
\let\digamma\relax
\let\smallsetminus\relax
\RequirePackage{amssymb}

% Quotation and French Styling
\RequirePackage{csquotes}
\setquotestyle{french}

% Additional Theorem Tools
\RequirePackage{thmtools}
\RequirePackage{afterpage}

% Graphics and Drawing Packages
\RequirePackage{graphicx}
\RequirePackage{interval}
% Pour que le séparateur décimal dans les intervalles soit ; à la place de la ,
\intervalconfig{separator symbol=;}

% Multi-column and Table Management
\RequirePackage{multicol}
\RequirePackage{multirow}
\RequirePackage{tabularx}
\RequirePackage{tabularray}
\setlength{\extrarowheight}{4pt}
\DefTblrTemplate{contfoot-text}{default}{}
\DefTblrTemplate{conthead-text}{default}{}
\DefTblrTemplate{caption}{default}{}
\DefTblrTemplate{conthead}{default}{}
\DefTblrTemplate{capcont}{default}{}

% Additional Utility Packages
\RequirePackage{etoolbox}
%\RequirePackage{icomma}
\RequirePackage{makecell}
\RequirePackage{rotating}
\RequirePackage{float}
\RequirePackage{lscape}
\RequirePackage[toc,page]{appendix}
\RequirePackage{framed}
\RequirePackage{color}
\RequirePackage{pst-circ,pstricks-add}
\RequirePackage{fancybox}
\RequirePackage{psfrag}
%\RequirePackage{niceframe}
\RequirePackage{psfrag}
\setlength{\parindent}{0pt}
\RequirePackage{fancyhdr}
\RequirePackage{bm}
\RequirePackage{xparse}
\RequirePackage{pdfpages}

% TikZ and Drawing Libraries
\RequirePackage{pgf,tikz,pgfplots}
\RequirePackage{tikz-3dplot}
\RequirePackage{tikz-cd}
\usetikzlibrary{arrows,calc, shapes.misc, intersections,decorations.markings, patterns, shapes.geometric, calc,positioning,fit,backgrounds,angles, perspective,tikzmark}
\RequirePackage{tkz-euclide}

% Page Geometry
\RequirePackage[top=1.8cm, bottom=1.8cm, left=1cm , right=1cm]{geometry}

% Version Control and Reference Count
\RequirePackage{version}
\RequirePackage{refcount}

% Task Management and Systeme
\RequirePackage{tasks}
\RequirePackage{systeme}

% SI Units Configuration
\RequirePackage{siunitx}
% Gestion des unités de mesure 
\sisetup{locale = FR, per-mode = symbol, range-phrase=--, range-units=single, product-units=single}
\newcommand{\da}[1]{\SI[mode=text]{#1}{}}
\newcommand{\tunit}[2]{\SI[mode=text]{#1}{#2}}
\newcommand{\nunit}[1]{\SI[mode=text]{}{#1}}
\DeclareSIUnit\fr{fr.}

% Custom Column Types
\newcolumntype{Y}{>{\centering\arraybackslash}X}

% Enumeration and List Customization
\RequirePackage[inline, shortlabels]{enumitem}
\setlist[enumerate]{align=left,leftmargin=1cm,itemsep=1pt,parsep=0pt,topsep=5pt,rightmargin=0.2cm, labelsep=0em, label=\alph*)}
\setlist[enumerate,2]{label=\roman*)}
\setlist[description]{align=left,leftmargin=10pt, itemindent=0pt,itemsep=3pt,parsep=0pt,topsep=5pt,rightmargin=0.2cm,labelsep=0.5em,font=\normalfont\bfseries}
\setlist[itemize]{align=left,labelsep=1em,leftmargin=*,itemsep=0pt,parsep=0pt,topsep=0pt,rightmargin=0cm}

% Inline Enumerations
\newlist{inumerate}{enumerate*}{1}
\setlist*[inumerate]{before=\vspace{6pt}\newline, align=right, afterlabel=\hspace{2pt}, itemjoin=\hspace{10pt}, label=\alph*)}
\newlist{inlineumerate}{enumerate*}{1}
\setlist*[inlineumerate]{before=\vspace{6pt}, afterlabel=\hspace{2pt}, itemjoin=\hspace{10pt}, label=\alph*)}

% Task Settings
\RequirePackage{tasks}
\settasks{
  %label-width = 1em ,
  %item-indent = 1em ,
  before-skip = 0.2em , % undo paragraph skip
  after-skip = 0.2em , % undo paragraph skip
 % label-offset=-0.5em,
  after-item-skip = 0.5em % undo paragraph skip
}

% Underline and Last Page Packages
\RequirePackage{ulem}
\RequirePackage{lastpage}


% Custom Fillers and Box Commands
\def\dotfill#1{\cleaders\hbox to #1{.}\hfill}
\makeatletter
\def\myrulefill{\leavevmode\leaders\hrule height .7ex width 1ex depth -0.6ex\hfill\kern\z@}
\makeatother
\newcommand{\bpage}{%
    \null
    \thispagestyle{empty}%
    \addtocounter{page}{-1}%
    \newpage}

\newcommand\blankpage{% comando pagina vuota
    \clearpage
    \begingroup
      \null
      \thispagestyle{empty}%
      \addtocounter{page}{-1}%
      \clearpage
    \endgroup
}
\newcommand{\tabitem}{~~\llap{\textbullet}~~}
\newcommand{\emptybox}{\fbox{\parbox[c][8mm]{8mm}{\ }}}
\newcommand{\boxt}[1]{\fbox{\parbox[c][8mm]{8mm}{\centering #1}}}
\newcommand{\ligne}[1]{\makebox[#1cm]{\hrulefill}} 
\newcommand{\points}[1]{\makebox[#1cm]{\dotfill}} 
\newcommand{\textLigne}[1]{\myrulefill {\bfseries #1} \myrulefill\par}
\newcommand{\relmiddle}[1]{\mathrel{}\middle#1\mathrel{}}

% Common Math Symbols
\newcommand{\R}{\mathbb R}
\newcommand{\N}{\mathbb N}
\newcommand{\Z}{\mathbb Z}
\newcommand{\Q}{\mathbb Q}

\sysaddeqsign{?}
\sysequivsign{?}{\stackrel{?}{=}}

\sysaddeqsign{!}
\sysequivsign{!}{\neq}

\newenvironment{solve}
 {%
\begin{equation*}
  \renewcommand{\arraystretch}{1.3}%
  \setlength{\arraycolsep}{0pt}%
  \begin{array}{
    >{\displaystyle}r   % right aligned
    >{\displaystyle{}}l % left aligned
    @{\hspace{4em}}     % spacing
    |                   % vertical rule
    @{\hspace{2em}}     % spacing
    >{\displaystyle}l  % comments
  }%
 }%
 {\end{array}
\end{equation*}}

\RequirePackage{hyperref}
\RequirePackage{qrcode}
\newcommand{\qrwithlabel}[2]{%
    \begin{minipage}{0.23\linewidth} % Adjust width to fit 4 on a line
        \centering
        \textbf{#1} \\ % Description on top
	\smallskip
	\href{#2}
	{\qrcode[height=3cm]{#2}} % QR code with fixed height
    \end{minipage}%
}
